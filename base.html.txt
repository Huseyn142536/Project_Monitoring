{% load static %}
<!doctype html>
<html lang="az">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Monitoring TNBİ{% endblock %}</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{% static 'img/favicon.png' %}">

    <!-- Lokal Bootstrap CSS -->
    <link rel="stylesheet" href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}">

    <!-- Lokal Bootstrap Icons CSS -->
    <link rel="stylesheet" href="{% static 'vendor/bootstrap-icons/bootstrap-icons-1.11.3/bootstrap-icons.css' %}">

    <!-- Layihə CSS-ləri -->
    <link rel="stylesheet" href="{% static 'css/qanunvericilik.css' %}">
    <link rel="stylesheet" href="{% static 'css/tasks.css' %}">

    {% block extra_css %}{% endblock %}

    <style>
      :root{
        --bg: #0d6efd;
        --bg2: #6610f2;
        --brand-color: #fff;
      }
      body.dark-mode {
        --brand-color: #111827;
        --bg: #111827;
        --bg2: #0f766e;
        background-color: #0b1220;
        color: #e6eef6;
      }

      /* Brand pill */
      .brand-pill{
        display:inline-flex;
        align-items:center;
        gap:.6rem;
        padding:.35rem .75rem;
        border-radius:999px;
        background: linear-gradient(90deg,var(--bg),var(--bg2));
        color:var(--brand-color) !important;
        box-shadow: 0 6px 18px rgba(13,110,253,0.18);
        font-weight:800;
        letter-spacing:.2px;
        font-size:1.02rem;
        transition: transform .12s ease, box-shadow .12s ease;
      }
      .brand-pill:hover{ transform: translateY(-3px) scale(1.01); box-shadow: 0 10px 30px rgba(13,110,253,0.22); }

      .brand-icon {
        display:inline-flex;
        align-items:center;
        justify-content:center;
        width:34px; height:34px;
        border-radius:.45rem;
        background: rgba(255,255,255,0.12);
        font-size:1.05rem;
      }

      .navbar .nav-link {
        display:flex;
        align-items:center;
        gap:.5rem;
        color: rgba(255,255,255,0.95) !important;
        padding:.45rem .7rem;
        border-radius:.45rem;
        font-weight:600;
        transition: background .12s ease, transform .06s ease;
      }
      .navbar .nav-link:hover{ background: rgba(255,255,255,0.04); transform: translateY(-1px); text-decoration:none; }

      .label-strong{ font-size:.95rem; }

      .theme-toggle-btn { border: none; background: transparent; color: rgba(255,255,255,0.9); display:flex; align-items:center; gap:.4rem; }
      .theme-toggle-btn:hover { color: #fff; transform: translateY(-2px); }

      @media (max-width:767px){
        .brand-pill{ font-size:.96rem; padding:.28rem .55rem; }
        .navbar .nav-link{ padding:.55rem .8rem; }
        .navbar-text{ display:none; }
      }

      .navbar-brand img {
        display:inline-block;
        vertical-align:middle;
        height:38px;
        width:auto;
        object-fit:contain;
        border-radius:6px;
        margin-right:.6rem;
      }
    </style>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="{% url 'task-list' %}">
          <img src="{% static 'img/logo.png' %}" alt="Logo" onerror="this.style.display='none'">
          <span class="brand-pill">
            <span class="brand-icon"><i class="bi bi-shield-lock-fill"></i></span>
            <span>Monitoring TNBİ</span>
          </span>
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Menyu">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0 align-items-lg-center">
            <li class="nav-item">
              <a class="nav-link" href="{% url 'task-list' %}">
                <i class="bi bi-list-task"></i>
                Tapşırıqlar
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link" href="{% url 'qanunvericilik-list' %}">
                <i class="bi bi-book"></i>
                Qanunvericilik
              </a>
            </li>

            {% if show_stats_link %}
            <li class="nav-item">
              <a class="nav-link" href="{% url 'admin-dashboard' %}">
                <i class="bi bi-bar-chart-line-fill"></i>
                Statistika
              </a>
            </li>
            {% endif %}
          </ul>

          <ul class="navbar-nav ms-auto mb-2 mb-lg-0 align-items-center">
            <li class="nav-item me-2 d-flex align-items-center">
              <button id="themeToggle" class="theme-toggle-btn" title="Tema dəyişdir">
                <i id="themeIcon" class="bi bi-moon-stars-fill"></i>
              </button>
            </li>

            {% if user.is_authenticated %}
              <li class="nav-item me-2 d-none d-lg-block">
                <span class="navbar-text text-white">Xoş gəlmisiniz, <strong>{{ user.username }}</strong></span>
              </li>
              <li class="nav-item">
                <form action="{% url 'logout' %}" method="post" class="d-flex align-items-center mb-0">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-outline-light btn-sm d-flex align-items-center">
                    <i class="bi bi-box-arrow-right me-1"></i> Çıxış
                  </button>
                </form>
              </li>
            {% else %}
              <li class="nav-item">
                <a class="nav-link" href="{% url 'login' %}">
                  <i class="bi bi-person-circle"></i> Giriş
                </a>
              </li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>

    <main class="container">
      {% block content %}{% endblock %}
    </main>

    <!-- Lokal Bootstrap JS -->
    <script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>

    <script>
      (function(){
        const key = 'monitoring_theme';
        const body = document.body;
        const btn = document.getElementById('themeToggle');
        const icon = document.getElementById('themeIcon');

        function setDark(d){
          if(d){
            body.classList.add('dark-mode');
            icon.className = 'bi bi-sun-fill';
          } else {
            body.classList.remove('dark-mode');
            icon.className = 'bi bi-moon-stars-fill';
          }
        }

        const saved = localStorage.getItem(key);
        setDark(saved === 'dark');

        if(btn){
          btn.addEventListener('click', function(e){
            e.preventDefault();
            const isDark = body.classList.contains('dark-mode');
            setDark(!isDark);
            localStorage.setItem(key, !isDark ? 'dark' : 'light');
          });
        }
      })();
    </script>

    {% block extra_js %}{% endblock %}
  </body>
</html>
